---
format:
  revealjs:
    theme: [default, custom.scss]
    slide-number: true
---

## List experiment 

```{r include=FALSE}
library(knitr)


opts_chunk$set(fig.width=9, fig.height=5, 
               fig.retina = 3, collapse = TRUE)
```

```{r setup}
# Packages
library(tidyverse)
library(DeclareDesign)
library(kableExtra)

# ggplot global options
theme_set(theme_bw(base_size = 20))
```


```{r}
# Data prep
load("attn_rep.RData")

cali = dle

remove(dle)

# Analysis
a = cali %>% 
  split(.$experiment) %>% 
  map(~difference_in_means(listA ~ trt_A, data = .)) %>% 
  map(tidy) %>% 
  bind_rows(.id = "experiment")

b = cali %>% 
  split(.$experiment) %>% 
  map(~difference_in_means(listB ~ trt_B, data = .)) %>% 
  map(tidy) %>% 
  bind_rows(.id = "experiment")

pool = cali %>% 
  mutate(id = row_number()) %>% 
  pivot_longer(cols = c(listA, listB)) %>% 
  rename(list = name, count = value) %>% 
  mutate(Z = ifelse(trt_A == 1 & list == "listA" | trt_B == 1 & list == "listB",
                    1, 0)) %>% 
  split(.$experiment) %>% 
  map(~ lm_robust(count ~ Z + list, clusters = id, se_type = "stata", data = .)) %>% 
  map(tidy) %>% 
  bind_rows(.id = "experiment") %>% 
  filter(term == "Z")
  
est_df = rbind(a, b, pool)

est_df$term = fct_relevel(est_df$term, "trt_A", "trt_B", "Z")
```

Now I am going to read you three things that make people angry or upset.

## List experiment {visibility="uncounted"}

Now I am going to read you three things that make people angry or upset. After I read all three, just tell me HOW MANY of them upset you.

## List experiment {visibility="uncounted"}

Now I am going to read you three things that make people angry or upset. After I read all three, just tell me HOW MANY of them upset you. I don't want to know which ones, just HOW MANY.

. . .

### Control group

1. The federal government increasing the tax on gasoline
2. Professional athletes getting million-dollar contracts
3. Large corporations polluting the environment

## List experiment {visibility="uncounted"}

Now I am going to read you three things that make people angry or upset. After I read all three, just tell me HOW MANY of them upset you. I don't want to know which ones, just HOW MANY.

### Treatment group

1. The federal government increasing the tax on gasoline
2. Professional athletes getting million-dollar contracts
3. Large corporations polluting the environment
4. **A black family moving next door**

## Double list experiment

```{r}
ggplot(est_df %>% filter(experiment == "X")) +
  aes(x = term, y = estimate, shape = term) +
  geom_hline(yintercept = 0, linetype = "dashed") + 
  geom_point(size = 4, position = position_dodge(width = 0.5)) +
  geom_linerange(aes(x = term, ymin = conf.low, ymax = conf.high), 
                 size = 1, position = position_dodge(width = 0.5)) +
  theme(legend.position = "none") +
  labs(subtitle = "Organization X", 
       x = "Estimator", 
       y = "Proportion support") +
  scale_x_discrete(labels = c("List A", "List B", "Pooled"))
```

::: aside
We want DLEs to look like this
:::

## Double list experiment {visibility="uncounted"}


```{r}
ggplot(est_df %>% filter(experiment == "Y")) +
  aes(x = term, y = estimate, shape = term) +
  geom_hline(yintercept = 0, linetype = "dashed") + 
  geom_point(size = 4, position = position_dodge(width = 0.5)) +
  geom_linerange(aes(x = term, ymin = conf.low, ymax = conf.high), 
                 size = 1, position = position_dodge(width = 0.5)) +
  theme(legend.position = "none") +
  labs(subtitle = "Organization Y", 
       x = "Estimator", 
       y = "Proportion support") +
  scale_x_discrete(labels = c("List A", "List B", "Pooled"))
```

::: aside
But if they look like this we are in trouble
:::

